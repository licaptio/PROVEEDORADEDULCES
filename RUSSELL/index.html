<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>PROVSOFT Monitor</title>

<style>
html,body{
  margin:0;
  padding:0;
  height:100%;
  overflow:hidden;
  background:#000;
  font-family:Arial, sans-serif;
}

/* CONTENEDOR CARRUSEL */
#container{
  position:relative;
  width:100%;
  height:100%;
  overflow:hidden;
}

.slide{
  position:absolute;
  width:100%;
  height:100%;
  transform:translateX(100%);
  transition:transform .4s ease;
}

.slide.active{ transform:translateX(0); z-index:2; }
.slide.prev{ transform:translateX(-100%); }

iframe{
  width:100%;
  height:100%;
  border:none;
  background:#fff;
}

/* BOTÓN CONFIG */
.gear{
  position:fixed;
  top:15px;
  right:15px;
  width:48px;
  height:48px;
  background:#ff7a00;
  color:#fff;
  border-radius:14px;
  display:grid;
  place-items:center;
  font-size:22px;
  z-index:2000;
  box-shadow:0 4px 10px rgba(0,0,0,.4);
}

/* PANEL CONFIG */
#configPanel{
  position:fixed;
  top:0;
  right:-85%;
  width:85%;
  height:100%;
  background:#111;
  color:#fff;
  transition:right .35s ease;
  z-index:3000;
  padding:20px;
  overflow:auto;
}

#configPanel.open{ right:0; }

.module{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:14px;
  background:#1c1c1c;
  border-radius:12px;
  margin-bottom:10px;
}

.toggle{
  width:46px;
  height:24px;
  background:#444;
  border-radius:20px;
  position:relative;
  cursor:pointer;
  transition:.3s;
}
.toggle.active{ background:#00c853; }
.toggle::after{
  content:"";
  position:absolute;
  top:3px;
  left:3px;
  width:18px;
  height:18px;
  background:#fff;
  border-radius:50%;
  transition:.3s;
}
.toggle.active::after{ left:25px; }

/* CONTROLES */
.controls{
  position:fixed;
  bottom:15px;
  right:15px;
  display:flex;
  gap:10px;
  z-index:2000;
}
.controls button{
  padding:12px 18px;
  font-size:18px;
  border:none;
  border-radius:10px;
  background:#ff7a00;
  color:#fff;
}
</style>
</head>

<body>

<div class="gear" onclick="toggleConfig()">⚙</div>

<div id="configPanel">
  <h2>Configuración</h2>
  <div id="moduleList"></div>
</div>

<div id="container"></div>

<div class="controls">
  <button onclick="prev()">⬅</button>
  <button onclick="next()">➡</button>
</div>

<script>
const defaultPages = [
  { id:"VDulce", file:"VDulce.html", enabled:true },
  { id:"VZapata", file:"VZapata.html", enabled:true },
  { id:"VRutaVTAMOB", file:"VRutaVTAMOB.html", enabled:true },
  { id:"INVTEORICOCIGPDD", file:"INVTEORICOCIGPDD.html", enabled:true },
  { id:"ALUMINIO", file:"ALUMINIO.html", enabled:true },
  { id:"CONVERRUSSELL", file:"CONVERRUSSELL.html", enabled:true },
  { id:"RUSSELLGYM", file:"RUSSELLGYM.html", enabled:true },
  { id:"VCigarro", file:"VCigarro.html", enabled:true },
  { id:"VLiquidos", file:"VLiquidos.html", enabled:true },
  { id:"TAUROCARRUSSELL", file:"TAUROCARRUSSELL.html", enabled:true },
  { id:"Vbryan", file:"Vbryan.html", enabled:true },
  { id:"VAccionesAC", file:"VAccionesAC.html", enabled:true },
  { id:"Vventaspdd26", file:"Vventaspdd26.html", enabled:true }
];

let slides = [];
let index = 0;
let autoRotate = null;

/* ===============================
   CONFIG INICIAL
=================================*/
let config = JSON.parse(localStorage.getItem("provsoft_pages"));
if(!Array.isArray(config)){
  config = defaultPages;
  localStorage.setItem("provsoft_pages", JSON.stringify(config));
}

/* ===============================
   PANEL
=================================*/
function toggleConfig(){
  document.getElementById("configPanel").classList.toggle("open");
}

function renderConfig(){
  const list = document.getElementById("moduleList");
  list.innerHTML="";
  config.forEach((m,i)=>{
    const div=document.createElement("div");
    div.className="module";
    div.innerHTML=`
      <span>${m.id}</span>
      <div class="toggle ${m.enabled?'active':''}"
        onclick="toggleModule(${i},this)">
      </div>
    `;
    list.appendChild(div);
  });
}

function toggleModule(i,el){
  config[i].enabled=!config[i].enabled;
  el.classList.toggle("active");
  localStorage.setItem("provsoft_pages",JSON.stringify(config));
  buildSlides();
}

/* ===============================
   CARRUSEL
=================================*/
function buildSlides(){

  const container=document.getElementById("container");
  container.innerHTML="";
  clearInterval(autoRotate);

  const active=config.filter(m=>m.enabled);

  if(active.length===0){
    container.innerHTML=
    "<div style='color:white;display:flex;height:100%;align-items:center;justify-content:center;font-size:20px;'>Sin módulos activos</div>";
    return;
  }

  active.forEach((m,i)=>{
    const div=document.createElement("div");
    div.className="slide";
    if(i===0) div.classList.add("active");
    div.innerHTML=`<iframe src="${m.file}" loading="lazy"></iframe>`;
    container.appendChild(div);
  });

  slides=document.querySelectorAll(".slide");
  index=0;

  if(slides.length>1){
    autoRotate=setInterval(()=>next(),30000);
  }
}

function showSlide(n){
  if(slides.length<=1) return;

  slides.forEach(s=>s.classList.remove("active","prev"));

  const old=index;
  index=(n+slides.length)%slides.length;

  slides[old].classList.add("prev");
  slides[index].classList.add("active");
}

function next(){ showSlide(index+1); }
function prev(){ showSlide(index-1); }

/* ===============================
   SWIPE
=================================*/
let startX=0;

document.addEventListener("touchstart",e=>{
  startX=e.touches[0].clientX;
},{passive:true});

document.addEventListener("touchend",e=>{
  const diff=startX-e.changedTouches[0].clientX;
  if(diff>60) next();
  if(diff<-60) prev();
},{passive:true});

/* ===============================
   INIT
=================================*/
renderConfig();
buildSlides();
</script>

</body>
</html>

